/*!
 * Bootstrap Fileselect v1.2
 * https://github.com/Neoflow/Bootstrap-Fileselect
 *
 * Released under the MIT license
 * https://github.com/Neoflow/Bootstrap-Fileselect/blob/master/LICENSE.md
 */
(function(b,c){var a=function(e,d){this.$fileInput=c(e);this.options=d;this.metadata=this.$fileInput.data();this.$inputGroup=c("<div>").addClass("input-group");this.$inputGroupBtn=c("<label>").addClass("input-group-btn");this.$browseBtn=c("<span>");this.$labelInput=c("<input>").attr("type","text").attr("readonly",true).addClass("form-control");this.translations={en:{browse:"Browse",rules:{numberOfFiles:"The number of uploadable files is limited to [num] file(s)",fileExtensions:"The files are restricted to following file extensions: [ext]",fileSize:"The file size is limited to [size]"}},de:{browse:"Durchsuchen",rules:{numberOfFiles:"Die Anzahl der hochladbaren Dateien ist limitiert auf [num] Datei(en)",fileExtensions:"Die Dateien sind eingeschränkt auf folgende Dateierweiterungen: [ext]",fileSize:"Die Grösse ist eingeschränkt auf [size] pro Datei"}}}};a.prototype={defaults:{browseBtnClass:"btn btn-primary",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>',limit:false,extensions:false,allowedFileSize:false,allowedFileExtensions:false,allowedNumberOfFiles:false,language:false},init:function(){this.config=this.loadConfig();this.translations=this.loadTranslation();this.$fileInput.hide().after(this.$inputGroup);this.$inputGroup.append(this.$inputGroupBtn,this.$labelInput);this.$inputGroupBtn.append(this.$browseBtn).append(this.$fileInput);this.$browseBtn.addClass(this.config.browseBtnClass).text(this.translations.browse).append(" &hellip;");if(this.config.browseIcon){this.$browseBtn.prepend(this.config.browseIcon,"&nbsp;&nbsp;")}this.$fileInput.on("change",c.proxy(this.changeEvent,this));return this},changeEvent:function(g){var f=this.$fileInput[0].files,d=c.map(f,function(e){return e.name}).join(", ");if(this.validateNumberOfFiles(f)&&this.valiateFileExtensions(f)&&this.validateFileSize(f)){this.$labelInput.val(d);return true}this.$fileInput.val(null);return false},loadConfig:function(){var d=c.extend({},this.defaults,this.options,this.metadata);if(typeof d.extensions==="string"){d.extensions=d.extensions.split(",")}return d},loadTranslation:function(){var e=this.config.language||navigator.language||navigator.userLanguage,d=c.map(this.translations,function(f,g){return g});if(c.inArray(e,d)===-1){e="en"}return this.translations[e]},validateNumberOfFiles:function(d){if(this.config.allowedNumberOfFiles&&d.length>parseInt(this.config.allowedNumberOfFiles)){alert(this.translations.rules.allowedNumberOfFiles.replace("[num]",this.config.allowedNumberOfFiles));return false}return true},valiateFileExtensions:function(e){var d=true;if(this.config.allowedFileExtensions){c.each(e,c.proxy(function(g,f){var h=f.name.replace(/^.*\./,"").toLowerCase();if(c.inArray(h,this.config.allowedFileExtensions)===-1){alert(this.translations.rules.fileExtensions.replace("[ext]",this.config.allowedFileExtensions.join(", ")));d=false;return d}},this))}return d},validateFileSize:function(e){var d=true;if(this.config.allowedFileSize){c.each(e,c.proxy(function(g,f){if(f.size>this.config.allowedFileSize){alert(this.translations.rules.fileSize.replace("[size]",Math.round(this.config.allowedFileSize/1024/1024)+"MB"));d=false;return d}},this))}return d}};a.defaults=a.prototype.defaults;c.fn.fileselect=function(d){return this.each(function(){new a(this,d).init()})};b.Fileselect=a})(window,jQuery);
/*!
 * Bootstrap Fileselect v1.4.0
 * https://github.com/Neoflow/Bootstrap-Fileselect
 *
 * Copyright 2016-2017 Neoflow
 *
 * Released under the MIT license
 * https://github.com/Neoflow/Bootstrap-Fileselect/blob/master/LICENSE.md
 */

!function(i,e){var t=function(i,t){this.$fileInput=e(i),this.options=t,this.$fileselect=e(this),this.metadata=this.$fileInput.data(),this.$inputGroup=e("<div>").addClass("input-group"),this.$inputGroupBtn=e("<label>").addClass("input-group-btn"),this.$browseBtn=e("<span>"),this.$labelInput=e("<input>").attr("type","text").attr("readonly",!0).addClass("form-control"),this.translations={en:{browse:"Browse",rules:{numberOfFiles:"The number of uploadable files is limited to [num] file(s)",fileExtensions:"The files are restricted to following file extensions: [ext]",fileSize:"The file size is limited to [size]"}},de:{browse:"Durchsuchen",rules:{numberOfFiles:"Die Anzahl der hochladbaren Dateien ist limitiert auf [num] Datei(en)",fileExtensions:"Die Dateien sind eingeschränkt auf folgende Dateierweiterungen: [ext]",fileSize:"Die Grösse ist eingeschränkt auf [size] pro Datei"}}}};t.prototype={defaults:{browseBtnClass:"btn btn-primary",browserBtnPosition:"right",limit:!1,extensions:!1,allowedFileSize:!1,allowedFileExtensions:!1,allowedNumberOfFiles:!1,language:!1,validationCallback:function(i,e){alert(i)}},init:function(){return this.$fileselect.trigger("bs.fs.initialize"),this.config=this.loadConfig(),this.translations=this.loadTranslation(),this.$fileInput.hide().after(this.$inputGroup),"left"===this.config.browseBtnPosition?this.$inputGroup.append(this.$inputGroupBtn,this.$labelInput):this.$inputGroup.append(this.$labelInput,this.$inputGroupBtn),this.$inputGroupBtn.append(this.$browseBtn).append(this.$fileInput).css("margin-bottom",0),this.$browseBtn.addClass(this.config.browseBtnClass).text(this.translations.browse),this.$fileInput.on("change",e.proxy(this.changeEvent,this)),this.$fileselect.trigger("bs.fs.initialized"),this},changeEvent:function(i){this.$fileselect.trigger("bs.fs.change");var t=this.$fileInput[0].files,n=e.map(t,function(i){return i.name}).join(", ");return this.validateNumberOfFiles(t)&&this.valiateFileExtensions(t)&&this.validateFileSize(t)?(this.$labelInput.val(n),!0):(this.$fileInput.val(null),this.$fileselect.trigger("bs.fs.changed"),!1)},loadConfig:function(){var i=e.extend({},this.defaults,this.options,this.metadata);return"string"==typeof i.allowedFileExtensions&&(i.allowedFileExtensions=i.allowedFileExtensions.split(",")),i},loadTranslation:function(){var i=this.config.language||navigator.language||navigator.userLanguage,t=e.map(this.translations,function(i,e){return e});return-1===e.inArray(i,t)&&(i="en"),this.translations[i]},validateNumberOfFiles:function(i){return!(this.config.allowedNumberOfFiles&&i.length>parseInt(this.config.allowedNumberOfFiles))||(this.config.validationCallback(this.translations.rules.numberOfFiles.replace("[num]",this.config.allowedNumberOfFiles),"allowedNumberOfFiles",this),!1)},valiateFileExtensions:function(i){var t=!0;return this.config.allowedFileExtensions&&e.each(i,e.proxy(function(i,n){var s=n.name.replace(/^.*\./,"").toLowerCase();if(-1===e.inArray(s,this.config.allowedFileExtensions))return this.config.validationCallback(this.translations.rules.fileExtensions.replace("[ext]",this.config.allowedFileExtensions.join(", ")),"allowedFileExtensions",this),t=!1},this)),t},validateFileSize:function(i){var t=!0;return this.config.allowedFileSize&&e.each(i,e.proxy(function(i,e){if(e.size>this.config.allowedFileSize)return this.config.validationCallback(this.translations.rules.fileSize.replace("[size]",Math.round(this.config.allowedFileSize/1024/1024)+"MB"),"allowedFileSize",this),t=!1},this)),t}},t.defaults=t.prototype.defaults,e.fn.fileselect=function(i){return this.each(function(){new t(this,i).init()})},i.Fileselect=t}(window,jQuery);